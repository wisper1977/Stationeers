# Remote Battery Controller
# Alias assignments
alias trans d0
alias rec d1
alias led d5

# main loop
main:
yield
# Read the ratio from all Station Batteries connected to local network
lb r0 -1388288459 Ratio Average

# Transmit the average ratio to the master
transmit:
a trans Setting r0   # Send the average ratio to the master

# Receive the updated running average from the master
receive:
l r1 rec Setting

# If no data received, set LED to 0 instead of displaying bad data
breqz r1 no_update
s led Setting r1      # Update the LED display with the received average
j main                # Restart main loop
