# Arc Furnace Array Controller for Single Furnace

# Alias assignments
alias ArcFurnace d0  # Furnace device
alias Vent d5        # Active vent device (to be turned on and set inward)

# Register aliases
alias hasInput r3    # Flag: Does the furnace have input?
alias hasOutput r1   # Flag: Is the furnace's output slot full?

# Main loop
start:
# Ensure the furnace is powered off initially
s d0 On 0  

# Check if the furnace has input material
ls hasInput d0 0 Occupied
beq hasInput 0 skip  # If no input, skip this furnace

# Check if the furnace's output slot is occupied
ls hasOutput d0 1 Occupied
beq hasOutput 1 skip  # If output is full, skip activation

# If we reached here, furnace can be activated
# Turn on the furnace and set the vent to inward
s d0 On 1  # Turn on the furnace
s d5 On 1  # Turn on the vent
s d5 Direction 1  # Set the vent to inward direction (example)

# End of logic, skip further checks
skip:
yield  # Pause execution before restarting
j start  # Restart the process
